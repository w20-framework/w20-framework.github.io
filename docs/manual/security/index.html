<!DOCTYPE html>



<html lang="en">
<head>



<title>
    Security
</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">


<link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,700,300,400" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Bitter:700" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" href="/assets/unify/css/style.css">
<link rel="stylesheet" href="/assets/unify/plugins/font-awesome/css/font-awesome.css">
<link rel="stylesheet" href="/css/style.css">



<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TLF968Z');</script>



<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "SoftwareApplication",
  "name" : "W20 framework",
  "publisher" : {
    "@type" : "Organization",
    "name" : "Open-Source Software"
  },
  "applicationCategory" : "web framework"
}
</script>



<meta property="og:title" content="Security" />
<meta property="og:description" content="W20 applications can be integrated with security backends to authenticate users and display views that are consistent with
the backend security model." />
<meta property="og:url" content="http://w20-framework.github.io/docs/manual/security/" />
<meta property="og:site_name" content="W20 framework" />
<meta property="og:image" content="http://w20-framework.github.io/img/opengraph-default.png" />



<link rel="search" type="application/opensearchdescription+xml" href="http://w20-framework.github.io/opensearch.xml" title="W20 framework" />



<script type="text/javascript">
    window.w20 = {
        state: {}
    };
</script>


</head>
<body class="homepage">
    
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TLF968Z"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <div id="header">
        <div class="header">
    <div class="container">
        <a class="logo" href="/">W20 framework</a>
        <div class="topbar hidden-xs hidden-sm">
            <ul class="loginbar pull-right">
                <li><i class="fa fa-stack-overflow"></i> <a target="_blank" href="http://stackoverflow.com/questions/ask?tags=w20">Ask a question</a></li>
                <li class="topbar-devider"></li>
                <li><i class="fa fa-github"></i> <a target="_blank" href="https://github.com/w20-framework">GitHub</a></li>
            </ul>
        </div>
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="fa fa-bars"></span>
        </button>
    </div>
    <div class="collapse navbar-collapse navbar-responsive-collapse" data-role="navigation" style="pointer-events: none;">
        <div class="container">
            <ul class="nav navbar-nav" style="pointer-events: auto;">
                <li>
                    <a href="/docs">Documentation</a>
                </li>
                <li>
                    <a href="/addons">Add-ons</a>
                </li>
                <li>
                    <a href="/themes">Themes</a>
                </li>
                <li>
                    <a href="/posts">Blog</a>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">
                        More
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="/project/community">Community</a></li>
                        <li><a href="/project/roadmap">Roadmap</a></li>
                        <li><a href="/project/faq">FAQ</a></li>
                        <li><a href="/tags">Tags</a></li>
                    </ul>
                </li>
                <li>
                    <i class="search fa fa-search search-btn"></i>
                    <div class="search-open">
                        <form method="GET" action="/search">
                            <div class="input-group animated fadeInDown">
                                <input id="search-field" type="text" class="form-control" placeholder="Search" name="q">
                                <span class="input-group-btn">
                                    <button class="btn-u" type="submit">Go</button>
                                </span>
                            </div>
                        </form>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>

        
<div class="title-header small">
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-sm-12">
                <h2>Documentation</h2>
                <p class="hidden-xs">Introduction, reference manual and JSDoc of the W20 framework.</p>
            </div>
            <div class="col-md-3 hidden-sm hidden-xs">
                <div class="header-image-wrapper">
                    <img class="header-image" src="/img/logos/w20-logo.svg">
                </div>
            </div>
        </div>
    </div>
</div>
<div class="title-subheader">
    <div class="container">
        <ul>
            <li><h3 class=''><i class="fa fa-play-circle"></i> <a href="/docs">Introduction</a></h3></li>
            <li><h3 class='active'><i class="fa fa-book"></i> <a href="/docs/manual">Manual</a></h3></li>
            <li><h3 class=''><i class="fa fa-cogs"></i> <a href="/docs/generator">Generator</a></h3></li>
            <li><h3><i class="fa fa-info-circle"></i> <a href="/jsdoc" target="_blank">JSDoc</a></h3></li>
            <li><h3><i class="fa fa-tag"></i> <a href="https://github.com/w20-framework/w20/releases" target="_blank">Releases</a></h3></li>
            <li><h3><i class="fa fa-github"></i> <a href="https://github.com/w20-framework/w20" target="_blank">Source</a></h3></li>
        </ul>
    </div>
</div>

    </div>
    <div id="content" class="container">
        <div class="row">
    <div class="col-md-9">
        <div class="content-wrapper">
            <div class="doc-content">
                <p>W20 applications can be integrated with security backends to authenticate users and display views that are consistent with
the backend security model.</p>

<div class="callout callout-danger">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
            
            
                <i class="fa fa-exclamation-triangle icon-2x"></i>
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>Before going into details, <strong>it is crucial to understand that a client-side Web application such as a W20 one can almost
never provide effective security</strong>. It is only a frontend that will reflect the security enforced in the backend, but
there is value in providing a consistent experience between what is possible in the UI and what is allowed by the
backend and W20 provides such an integration.</p>

        </div>
    </div>
</div>

<h1 id="the-security-model">The security model</h1>

<h2 id="subject-and-principals">Subject and principals</h2>

<p>The subject is the security term which refers to a security-centric view of an application user. It always have an
identifier. A particular W20 application instance can only have zero or one subject connected at a time.
Principals are key/value pairs associated to a subject and provide additional metadata about it, like its default culture,
its full name, its avatar, etc.</p>

<h2 id="security-providers">Security providers</h2>

<p>Security providers are the bridge between the backend and the W20 security model. Authentication operations are
done through security providers.</p>

<h3 id="simple-authentication-provider">Simple authentication provider</h3>

<p>W20 provides a <code>SimpleAuthenticationProvider</code> which is configured with two URL:</p>

<ul>
<li>an authentication URL which will be requested with a GET upon authentication and a DELETE upon deauthentication.</li>
<li>an authorization URL which will be requested with a GET upon successful authentication to retrieve subject authorizations.</li>
</ul>

<p>The credentials will be passed in clear as query parameters upon authentication so it is recommended that this provider
is only used in the case of <a href="https://tools.ietf.org/html/rfc2617">basic authentication</a> where credentials can be omitted as they are directly handled by the
browser.</p>

<h2 id="realms">Realms</h2>

<p>Realms allow a W20 application to use several security backends at once. Security operations involving the backend(s)
like authentication will be done on all security realms. The multiple responses are checked for coherence (they must
all refer to the same subject id for instance) and are partially aggregated:</p>

<ul>
<li>Subject identity (like its identifier, type and principals) are merged as one definition,</li>
<li>Subject authorizations are kept separate to avoid mixing backend security models.</li>
</ul>

<h2 id="permissions">Permissions</h2>

<p>W20 security model is permission-based. Permissions are arrays of strings which denote a specific right to do something
in the application:</p>

<pre><code>[ 'admin', 'restart' ]
[ 'admin', 'database', 'wipe' ]
[ 'users', 'list', 'create,read,update' ]
[ 'users', 'details', '*' ]
[ 'printers', 'lp457', 'print' ]
</code></pre>

<p>Permission names are completely arbitrary and developer defined but it is recommended to start from the least-specific
term (like a &laquo;functional area&raquo; of the application or a use case) to the most specific term (like an action or an entity
identifier).</p>

<div class="callout callout-tips">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
                <i class="fa fa-lightbulb-o icon-2x" style="line-height: 30px;"></i>
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>Permission can also be expressed as colon-delimited strings: <code>users:details:*</code> is equivalent to <code>[ 'users', 'details', '*' ]</code>.</p>

        </div>
    </div>
</div>

<h2 id="roles">Roles</h2>

<p>Roles are simply collections of permissions and, although they can be checked for explicitly, it is not recommended for
the application security model maintainability. The recommendation is to design the permissions such as they express the
intent of the associated use case or user action and to check for these permissions only. It is guaranteed that as long
as the user action exists in the code the permission will remain semantically valid, whereas how it is given can change
throughout application life.</p>

<h2 id="attributes">Attributes</h2>

<p>Attributes can be attached to roles and checked for during a permission or role check. It is mainly used to restrict
a role scope to a geographic region or an organisational branch for instance.</p>

<h1 id="configuration">Configuration</h1>

<p>The security module can be configured with the following options:</p>

<ul>
<li><code>autoLogin</code> will automatically trigger an authentication upon application startup. In this case, security providers
will be called without credentials. They can ask for credentials at this points or let the browser handle credential
entry (as it is the case in basic authentication for instance).</li>
<li><code>redirectAfterLogin</code> will redirect to the specified route path after a successful login.</li>
<li><code>redirectAfterLogout</code> will redirect to the specified route path after a logout.</li>
<li><code>roleMapping</code> will allow to map multiple backend roles to uniquely named unified frontend roles.</li>
</ul>

<h2 id="role-mapping">Role mapping</h2>

<p>W20 security allows to map several backend roles to a unified frontend role which can then be used for display or
filtering purpose. It can be done through the <code>roleMapping</code> configuration attribute:</p>

<pre><code>&quot;roleMapping&quot;: {
    &quot;UNIFIED_ROLE&quot;: {
        &quot;realm1&quot;: &quot;SOME_BACKEND_ROLE&quot;,
        &quot;realm2&quot;: &quot;OTHER_BACKEND_ROLE&quot;
    }
}
</code></pre>

<p>This configuration enables to view the two backend roles, defined from two different realms as one frontend role
called <code>UNIFIED_ROLE</code>. If only one security realm is declared in the application, all backend roles of this realm will
automatically be mapped to unified roles of the same name.</p>

<h1 id="fragment-declaration">Fragment declaration</h1>

<p>Security providers can be registered programatically with the authentication service but can also be declared in a fragment
manifest:</p>

<pre><code>...

&quot;security&quot;: {
    &quot;provider&quot;: &quot;Simple&quot;,
    &quot;config&quot;: {
        &quot;authentication&quot;: &quot;...&quot;,
        &quot;authorizations&quot;: &quot;...
    }
}

...
</code></pre>

<p>This will register a security realm with the name of the fragment identifier, using the <code>SimpleSecurityProvider</code>
service as the security provider configured with the <code>config</code> section.</p>

<h1 id="security-services">Security services</h1>

<h2 id="authentication-service">Authentication service</h2>

<p>The authentication service can be used to alter the currently connected subject:</p>

<ul>
<li>Authenticate a new subject with its credentials and define it as the globally active subject.</li>
<li>Deauthenticate the currently active subject.</li>
<li>Refresh the currently active subject.</li>
</ul>

<p>The authentication service can also be used to query identity information about the subject, such as its identifier or
its principals.</p>

<h2 id="authorization-service">Authorization service</h2>

<p>The authorization service can be used to verify specific authorizations on the currently active subject and on a specific
realm:</p>

<ul>
<li>If the subject has a specific role (with possibly specific attributes).</li>
<li>If the subject has a specific permission (with possibly specific attributes).</li>
</ul>

<p>It can also be used to query the list of roles, although it is limited to the unified roles.</p>

<h2 id="security-expression-service">Security expression service</h2>

<p>Security expressions are a simple and effective way of checking the authentication and authorization status of the
currently active subject. Inject the <code>SecurityExpressionService</code> to evaluate them. Security expressions are normal
AngularJS expressions with the following additional functions available:</p>

<ul>
<li><code>hasPermission(realm, permission, attributes)</code> which checks a permission for the currently active subject,</li>
<li><code>hasRole(realm, role, attributes)</code> which checks if the currently active subject has a specific role,</li>
<li><code>isAuthenticated()</code> which checks if there is a currently active subject,</li>
<li><code>principal(name)</code> which returns the value of a specific principal</li>
</ul>

<p>The result of the security expression is evaluated as a boolean:</p>

<pre><code>var result = securityExpressionService.evaluate(&quot;hasPermission('someRealm', 'users:details:clear')&quot;);
</code></pre>

<h1 id="security-directive">Security directive</h1>

<p>The <code>w20Security</code> directive allows to evaluate a security expression in a view and display the element only if it
evaluates to true. The expression is evaluated in its current scope, augmented with the security expression service operations described above:</p>

<pre><code>&lt;div data-w20-security=&quot;hasRole('someRealm', 'someRole')&quot;&gt;
    ...
&lt;/div&gt;
</code></pre>

<p>Or:</p>

<pre><code>&lt;div data-w20-security=&quot;someLocalScopeVariable &amp;&amp; hasPermission('someRealm', 'users:details:clear')&quot;&gt;
    ...
&lt;/div&gt;
</code></pre>

<h1 id="role-filtering">Role filtering</h1>

<p>W20 security can narrow the authorizations of the currently active subject by setting up filters:</p>

<ul>
<li>role filter narrows the authorizations to the specified roles. Any permission or role not allowed by the filter will
be denied until this filter is cancelled.</li>
<li>attribute filter narrows the authorizations on which the specified attribute values are attached. Any permission
or role which don&rsquo;t have the specified attribute values will be denied until this filter is cancelled.</li>
</ul>

<p>Filtering is limited to unified roles.</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        
<div class="side-menu">
    
        
        <div class="list-group">
            <ul class="nav">
                
                
                
                    
                    <li>
                        <a href="/docs/manual/" class="list-group-item ">
                            Web framework basics
                        </a>
                        
                        
                    </li>
                    
                
                    
                    <li>
                        <a href="/docs/manual/routing/" class="list-group-item ">
                            Routing
                        </a>
                        
                        
                    </li>
                    
                
                    
                    <li>
                        <a href="/docs/manual/security/" class="list-group-item  active ">
                            Security
                        </a>
                        
                        
                            <nav id="TableOfContents">
<ul>
<li><a href="#the-security-model">The security model</a>
<ul>
<li><a href="#subject-and-principals">Subject and principals</a></li>
<li><a href="#security-providers">Security providers</a>
<ul>
<li><a href="#simple-authentication-provider">Simple authentication provider</a></li>
</ul></li>
<li><a href="#realms">Realms</a></li>
<li><a href="#permissions">Permissions</a></li>
<li><a href="#roles">Roles</a></li>
<li><a href="#attributes">Attributes</a></li>
</ul></li>
<li><a href="#configuration">Configuration</a>
<ul>
<li><a href="#role-mapping">Role mapping</a></li>
</ul></li>
<li><a href="#fragment-declaration">Fragment declaration</a></li>
<li><a href="#security-services">Security services</a>
<ul>
<li><a href="#authentication-service">Authentication service</a></li>
<li><a href="#authorization-service">Authorization service</a></li>
<li><a href="#security-expression-service">Security expression service</a></li>
</ul></li>
<li><a href="#security-directive">Security directive</a></li>
<li><a href="#role-filtering">Role filtering</a></li>
</ul>
</nav>
                            <script>
                                w20.state.previousPage = '\/docs\/manual\/routing\/';
                            </script>
                            
                        
                    </li>
                    
                
                    
                    <li>
                        <a href="/docs/manual/culture/" class="list-group-item ">
                            Culture
                        </a>
                        
                            <script>
                                w20.state.nextPage = '\/docs\/manual\/culture\/';
                            </script>
                            
                        
                        
                    </li>
                    
                
                    
                    <li>
                        <a href="/docs/manual/hypermedia/" class="list-group-item ">
                            Hypermedia
                        </a>
                        
                        
                    </li>
                    
                
                    
                    <li>
                        <a href="/docs/manual/ui/" class="list-group-item ">
                            UI
                        </a>
                        
                        
                    </li>
                    
                
                    
                    <li>
                        <a href="/docs/manual/testing/" class="list-group-item ">
                            Testing
                        </a>
                        
                        
                    </li>
                    
                
            </ul>
        </div>
        
    
    
    <div class="list-group">
        <ul class="nav">
            <li class="list-group-item"><div style="margin-bottom: 10px;"><i class="fa fa-tag"></i> Tags</div>
                <div class="tags">
                    
                    <a class="label label-default" href="/tags/permission">Permission</a>
                    
                    <a class="label label-default" href="/tags/authentication">Authentication</a>
                    
                    <a class="label label-default" href="/tags/authorization">Authorization</a>
                    
                    <a class="label label-default" href="/tags/role">Role</a>
                    
                </div>
            </li>
        </ul>
    </div>
    
    <div class="list-group">
        <ul class="nav">
            
                <li><a class="list-group-item" href="https://github.com/w20-framework/website/edit/master/content/docs/manual/security.md" target="_blank"><i class="fa fa-edit"></i> Contribute to this page</a></li>
            
        </ul>
    </div>
</div>

    </div>
</div>

    </div>
    <div id="footer">
        <div class="footer-v3">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 md-margin-bottom-40">
                    <div class="headline"><h2>About</h2></div>
                    <p class="margin-bottom-25 md-margin-bottom-40">W20 is a Web framework to create modular and composable enterprise-ready applications.</p>
                </div>

                <div class="col-md-4 md-margin-bottom-40">
                    <div class="posts">
                        <div class="headline"><h2>License</h2></div>
                        <p>
                            Code licensed under the <a href="https://www.mozilla.org/MPL/2.0" target="_blank">Mozilla Public License 2.0</a>.
                            <br/>
                            Documentation licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.
                        </p>
                    </div>
                </div>

                <div class="col-md-4 map-img">
                    <div class="headline"><h2>Contact us</h2></div>
                    <address>
                        <p>
                            StackOverflow <a href="https://stackoverflow.com/questions/tagged/w20">W20 on StackOverflow</a>
                        </p>
                    </address>
                </div>
            </div>
        </div>
    </div>
</div>

    </div>
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/github.min.css">

    <script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mousetrap/1.4.6/mousetrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lunr.js/0.5.9/lunr.min.js"></script>
<script src="/assets/unify/plugins/smoothScroll.js"></script>
<script src="/js/jquery.highlight.js"></script>
<script src="/js/w20.js"></script>
<script>
    $(document).ready(function () {
        var $search = $('.search-btn');

        $('.search').click(function () {
            if ($search.hasClass('fa-search')) {
                w20.ui.openSearch();
            } else {
                w20.ui.closeSearch();
            }
        });

        $('pre code').each(function (i, block) {
            hljs.highlightBlock(block);
        });

        $('.side-menu').affix({
            offset: {
                top: $('#header').height() + 20,
                bottom: $('#footer').height() + 40
            }
        });

        Mousetrap.bind('/', function () {
            w20.ui.openSearch();
            return false;
        });

        Mousetrap.bind('alt+up', function () {
            if (w20.state.previousPage) {
                window.location = w20.state.previousPage;
            }
            return false;
        });

        Mousetrap.bind('alt+down', function () {
            if (w20.state.nextPage) {
                window.location = w20.state.nextPage;
            }
            return false;
        });

        Mousetrap.bind('esc', function () {
            w20.ui.closeSearch();
            return false;
        });

        var originalCallback = Mousetrap.stopCallback;
        Mousetrap.stopCallback = function (e, element, combo) {
            if (combo === 'esc') {
                return false;
            }

            return originalCallback(e, element, combo);
        };

        $('[data-toggle="tooltip"]').tooltip();

        $('#hotkeys-modal, #versions-modal').bind('hidden.bs.modal', function () {
            $("html").css("margin-right", "0px");
        }).bind('show.bs.modal', function () {
            $("html").css("margin-right", "-15px");
        });

        var query = w20.strings.parseQueryString(location);
        if (query.h && query.h.length > 0) {
            $('.doc-content').highlight(query.h);
            if (query.scroll) {
                $('html, body').animate({
                    scrollTop: $('span[class=highlight]:first').offset().top - 20
                }, 250);
            }
        }
    });
</script>


</body>
</html>