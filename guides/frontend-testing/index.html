<!DOCTYPE html>
<html lang="en">
<head>
    


<title>
    Frontend testing
</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">


<link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,700,300,400" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Bitter:700" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" href="/assets/unify/css/style.css">
<link rel="stylesheet" href="/assets/unify/plugins/font-awesome/css/font-awesome.css">
<link rel="stylesheet" href="/css/style.css">



<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TLF968Z');</script>



<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "SoftwareApplication",
  "name" : "W20 framework",
  "publisher" : {
    "@type" : "Organization",
    "name" : "Open-Source Software"
  },
  "applicationCategory" : "web framework"
}
</script>



<meta property="og:title" content="Frontend testing" />
<meta property="og:description" content="As your application grows it becomes harder to assert that all your features are still working correctly. Whether you are doing some refactoring, upgrading a library version or adding new features, you would want a mechanism to protect yourself from regression. Testing is well known for Java EE server side application but your front end web application also deserves unit testing especially when complex logic are involved.
Unit testing as the name implies is about testing individual units of code." />
<meta property="og:url" content="http://w20-framework.github.io/guides/frontend-testing/" />
<meta property="og:site_name" content="W20 framework" />
<meta property="og:image" content="http://w20-framework.github.io/img/opengraph-default.png" />



<link rel="search" type="application/opensearchdescription+xml" href="http://w20-framework.github.io/opensearch.xml" title="W20 framework" />



<script type="text/javascript">
    window.w20 = {
        state: {}
    };
</script>


</head>
<body>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TLF968Z"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<div id="header">
    <div class="header">
    <div class="container">
        <a class="logo" href="/">W20 framework</a>
        <div class="topbar hidden-xs hidden-sm">
            <ul class="loginbar pull-right">
                <li><i class="fa fa-stack-overflow"></i> <a target="_blank" href="http://stackoverflow.com/questions/ask?tags=w20">Ask a question</a></li>
                <li class="topbar-devider"></li>
                <li><i class="fa fa-github"></i> <a target="_blank" href="https://github.com/w20-framework">GitHub</a></li>
            </ul>
        </div>
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="fa fa-bars"></span>
        </button>
    </div>
    <div class="collapse navbar-collapse navbar-responsive-collapse" data-role="navigation" style="pointer-events: none;">
        <div class="container">
            <ul class="nav navbar-nav" style="pointer-events: auto;">
                <li>
                    <a href="/docs">Documentation</a>
                </li>
                <li>
                    <a href="/addons">Add-ons</a>
                </li>
                <li>
                    <a href="/themes">Themes</a>
                </li>
                <li>
                    <a href="/posts">Blog</a>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">
                        More
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="/project/community">Community</a></li>
                        <li><a href="/project/roadmap">Roadmap</a></li>
                        <li><a href="/project/faq">FAQ</a></li>
                        <li><a href="/tags">Tags</a></li>
                    </ul>
                </li>
                <li>
                    <i class="search fa fa-search search-btn"></i>
                    <div class="search-open">
                        <form method="GET" action="/search">
                            <div class="input-group animated fadeInDown">
                                <input id="search-field" type="text" class="form-control" placeholder="Search" name="q">
                                <span class="input-group-btn">
                                    <button class="btn-u" type="submit">Go</button>
                                </span>
                            </div>
                        </form>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>

    <div class="title-header small">
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-sm-12">
                <h2>Guides</h2>
                <p class="hidden-xs">Hands-on instructions and detailed insight applicable to W20-based projects.</p>
            </div>
            <div class="col-md-3 hidden-sm hidden-xs">
                <div class="header-image-wrapper">
                    <img class="header-image" src="/img/logos/guides-logo.svg">
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="title-subheader">
        <div class="container">
            <ul>
                <li><h3><i class="fa fa-list"></i> <a href="/guides">All guides</a></h3></li>
                <li><h3 class="active"><i class="fa fa-book"></i> <a href="">Frontend testing</a></h3></li>
            </ul>
        </div>
    </div>
</div>
<div id="content" class="container">
    <div class="row">
    <div class="col-md-9">
        <div class="content-wrapper">
            <div class="doc-content">
                

<p>As your application grows it becomes harder to assert that all your features are still working correctly. Whether you are
doing some refactoring, upgrading a library version or adding new features, you would want a mechanism to protect yourself
from regression. Testing is well known for Java EE server side application but your front end web application also deserves
unit testing especially when complex logic are involved.</p>

<p>Unit testing as the name implies is about testing individual units of code. Unit tests try to answer questions such as
&laquo;Did I think about the logic correctly?&raquo; or &laquo;Does the sort function order the list in the right order?&raquo;.</p>

<div class="callout callout-info">
<p>W20 itself is agnostic of the testing framework and the test runner but you may have good results with respectively
<a href="http://jasmine.github.io/">Jasmine</a> and <a href="http://karma-runner.github.io/">Karma</a>.</p>
</div>

<h1 id="writing-unit-tests">Writing unit tests</h1>

<p>Instead of repeating in a less complete way what the documentation on Jasmine <a href="http://jasmine.github.io/2.1/introduction.html">Jasmine</a>
and <a href="http://docs.angularjs.org/guide/dev_guide.unit-testing">AngularJS</a> have to offer on testing, we are going
to follow an example and see how we can test our individual unit of code.</p>

<h2 id="the-code-to-test">The code to test</h2>

<p>We will use the example of a small CRUD application for managing users. The code that we will test consists of a service
&lsquo;UsersService&rsquo; that retrieve users and an angular controller which holds some functions : addUser, loadUsers and clearUsers.</p>

<pre><code>module.factory('UsersService', [ '$resource', function($resource) {
    return {
        usersResource: $resource(require.toUrl('{fragmentRoot}/data/users.json'))
    };
}]);

module.controller('UserController', [ '$scope', 'UsersService', function ($scope, usersService) {

    var userId = 0;
    var Users = usersService.usersResource;

    // User array initialization
    $scope.users = [];

    // This function add the current entered user to the user array
    $scope.addUser = function () {
        $scope.users.push({
            id: (++userId).toString(),
            firstName: $scope.firstName,
            lastName: $scope.lastName,
        });
    };

    // This function loads users from a resource
    $scope.loadUsers = function () {
        Users.query(function (result) {
            for (var i = 0; i &lt; result.length; i++)
                if (result[i].id &gt; userId)
                    userId = result[i].maxid;
            $scope.users = result;
        });
    };

    // This function clears the user array
    $scope.clearUsers = function () {
        $scope.users = [];
    };

]);
</code></pre>

<p>We can now start writing some tests in our user.test.js file.</p>

<h2 id="unit-test-structure">Unit test structure</h2>

<p>A <b>test suite</b> begins with a call to the global Jasmine function <code>describe</code> with two parameters: a string and a function. The string is a name or title
for a spec suite â€“ usually what is under test. The function is a block of code that implements the suite.</p>

<pre><code>describe(&quot;A suite&quot;, function() {
  it(&quot;contains spec with an expectation&quot;, function() {
    expect(true).toBe(true);
  });
});
</code></pre>

<p><b>Specs</b> are defined by calling the global Jasmine function <code>it</code>, which, like <code>describe</code> takes a string and a function.
The string is a title for this spec and the function is the spec, or test. A spec contains one or more expectations that test the state of the code under test.
An expectation in Jasmine is an assertion that can be either true or false. A spec with all true expectations is a passing spec.
A spec with one or more expectations that evaluate to false is a failing spec.</p>

<pre><code>describe(&quot;A suite of spec&quot;, function() {
  var a;
  it(&quot;is a spec and variable a should be true &quot;, function() {
    a = true;
    expect(a).toBe(true);
  });
});
</code></pre>

<p>Jasmine also provides the global <code>beforeEach</code> and <code>afterEach</code> functions.
As the name implies the beforeEach function is called once before each spec in the describe is run and the afterEach function is called once after each spec.</p>

<pre><code>describe(&quot;A spec (with setup and tear-down)&quot;, function() {
  var foo;

  beforeEach(function() {
    foo = 0;
    foo += 1;
  });

  afterEach(function() {
    foo = 0;
  });

  it(&quot;is just a function, so it can contain any code&quot;, function() {
    expect(foo).toEqual(1);
  });

  it(&quot;can have more than one expectation&quot;, function() {
    expect(foo).toEqual(1);
    expect(true).toEqual(true);
  });
});
</code></pre>

<h1 id="example">Example</h1>

<p>With those basic concepts we can now start writing some tests for our code sample. Before writing the test suite we want
to get our hand on the service and controller inside our test file. We do this by using the <code>beforeEach</code> function :</p>

<pre><code>define([
    '{angular}/angular',
    '{angular-mocks}/angular-mocks'
    '{my-fragment}/modules/user'
], function(angular) {
    var userController, $scope;

    beforeEach(function () {
        // Load the user module, which contains the service and controller
        module('user');

        // inject services that will allow us to get our hands on the required components we want to unit test
        inject(function ($injector, $controller, $rootScope) {

            // Create an object 'serviceMock' with a property 'usersResource'.
            // We do this so that later on we can use it as a spy for call on the UsersService.usersResource.query()
            serviceMock = {
                       usersResource: {}
                   };

            // Get a new child scope from the root scope which will served in our specs
            $scope = $rootScope.$new();

            // Get the 'UserController' and map its $scope dependency to the one defined above and its
            // 'UsersService' dependency as the 'serviceMock' we defined above
            userController = $controller('UserController', {
                $scope: $scope,
                UsersService: serviceMock
            });
        });
    });
});
</code></pre>

<p>We now have all our components ready for our test suite. Remember that a test suite is defined with <code>describe</code> :</p>

<pre><code> describe(&quot;the user controller&quot;, function () { ... }
</code></pre>

<p>Inside of this test suite we can write our specs :</p>

<pre><code>// Check that initialization is correct
it(&quot;should have empty users collection when initialized&quot;, function () {
        // assert that $scope.users exists
        expect($scope.users).toBeDefined();
        // assert it is empty
        expect($scope.users.length).toEqual(0);
});

// Unit test the adduser() method
it(&quot;should be able to add items to the users collection&quot;, function () {
       $scope.firstName = 'Robert';
       $scope.lastName = 'SMITH';

       $scope.addUser();

       expect($scope.users.length).toEqual(1);
       expect($scope.users).toContain({
           id: '1',
           firstName: 'Robert',
           lastName: 'SMITH'
       });
   });

// Unit test the clearUsers() method
it(&quot;should be able to clear the users collection&quot;, function () {
        $scope.users.push({
            id: '1',
            firstName: 'Robert',
            lastName: 'SMITH'
        });
        expect($scope.users.length).toEqual(1);

        $scope.clearUsers();

        expect($scope.users.length).toEqual(0);
    });

// Unit test the loadUsers() method
it(&quot;should be able to load data to the users collection&quot;, function () {

        // We are going to turn query() into a dummy function;
        // The .andCallFake() specify what the call to query()
        // should do. We created a spy. Then we test it (with loadUsers())
        //
        serviceMock.usersResource.query = jasmine.createSpy().andCallFake(function (callback) {
            callback([
                {
                    id: '1',
                    firstName: 'Robert',
                    lastName: 'SMITH'
                }
            ]);
        });

        // loadUsers() will trigger a call to usersService.usersResource.query
        // which is mocked by serviceMock.usersResource.query
        $scope.loadUsers();

        expect($scope.users.length).toEqual(1);
        expect($scope.users).toContain({
            id: '1',
            firstName: 'Robert',
            lastName: 'SMITH'
        });

        $scope.firstName = 'Anna';
        $scope.lastName = 'O\'HARA';
        $scope.addUser();

        expect($scope.users.length).toEqual(2);
        expect($scope.users).toContain({
            id: '1',
            firstName: 'Robert',
            lastName: 'SMITH'
        }, {
            id: '2',
            firstName: 'Anna',
            lastName: 'O\'HARA'
        });
    });
</code></pre>

<h1 id="full-code">Full code</h1>

<p>To conclude here is the entire user.test.js file :</p>

<pre><code>define([
    '{angular}/angular',
    '{angular-mocks}/angular-mocks'
    '{my-fragment}/modules/user'
], function(angular) {
    var userController, $scope;

    beforeEach(function () {
        module('user');
        inject(function ($injector, $controller, $rootScope) {
            serviceMock = {
                usersResource: {}
            };

            $scope = $rootScope.$new();

            userController = $controller('UserController', {
                $scope: $scope,
                UsersService: serviceMock
            });
        });
    });

    describe(&quot;the user controller&quot;, function () {
        it(&quot;should have empty users collection when initialized&quot;, function () {
            expect($scope.users).toBeDefined();
            expect($scope.users.length).toEqual(0);
        });

        it(&quot;should be able to add items to the users collection&quot;, function () {
            $scope.firstName = 'Robert';
            $scope.lastName = 'SMITH';
            $scope.addUser();

            expect($scope.users.length).toEqual(1);
            expect($scope.users).toContain({
                id: '1',
                firstName: 'Robert',
                lastName: 'SMITH'
            });
        });

        it(&quot;should be able to clear the users collection&quot;, function () {
            $scope.users.push({
                id: '1',
                firstName: 'Robert',
                lastName: 'SMITH'
            });

            expect($scope.users.length).toEqual(1);
            $scope.clearUsers();
            expect($scope.users.length).toEqual(0);
        });

        it(&quot;should be able to load data to the users collection&quot;, function () {
            serviceMock.usersResource.query = jasmine.createSpy().andCallFake(function (callback) {
                callback([
                    {
                        id: '1',
                        firstName: 'Robert',
                        lastName: 'SMITH'
                    }
                ]);
            });
            $scope.loadUsers();

            expect($scope.users.length).toEqual(1);
            expect($scope.users).toContain({
                id: '1',
                firstName: 'Robert',
                lastName: 'SMITH'
            });

            $scope.firstName = 'Anna';
            $scope.lastName = 'O\'HARA';
            $scope.addUser();

            expect($scope.users.length).toEqual(2);
            expect($scope.users).toContain({
                id: '1',
                firstName: 'Robert',
                lastName: 'SMITH'
            }, {
                id: '2',
                firstName: 'Anna',
                lastName: 'O\'HARA'
            });
        });
    });
});
</code></pre>

            </div>
        </div>
    </div>
    <div class="col-md-3">
        
<div class="side-menu">
    
    
    <div class="list-group">
        <ul class="nav">
            
                <li><a class="list-group-item" href="https://github.com/w20-framework/website/edit/master/content/guides/frontend-testing/index.md" target="_blank"><i class="fa fa-edit"></i> Contribute to this page</a></li>
            
        </ul>
    </div>
</div>

    </div>
</div>

</div>
<div id="footer">
    <div class="footer-v3">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 md-margin-bottom-40">
                    <div class="headline"><h2>About</h2></div>
                    <p class="margin-bottom-25 md-margin-bottom-40">W20 is a Web framework to create modular and composable enterprise-ready applications.</p>
                </div>

                <div class="col-md-4 md-margin-bottom-40">
                    <div class="posts">
                        <div class="headline"><h2>License</h2></div>
                        <p>
                            Code licensed under the <a href="https://www.mozilla.org/MPL/2.0" target="_blank">Mozilla Public License 2.0</a>.
                            <br/>
                            Documentation licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.
                        </p>
                    </div>
                </div>

                <div class="col-md-4 map-img">
                    <div class="headline"><h2>Contact us</h2></div>
                    <address>
                        <p>
                            StackOverflow <a href="https://stackoverflow.com/questions/tagged/w20">W20 on StackOverflow</a>
                        </p>
                    </address>
                </div>
            </div>
        </div>
    </div>
</div>

</div>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/github.min.css">

<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mousetrap/1.4.6/mousetrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lunr.js/0.5.9/lunr.min.js"></script>
<script src="/assets/unify/plugins/smoothScroll.js"></script>
<script src="/js/jquery.highlight.js"></script>
<script src="/js/w20.js"></script>
<script>
    $(document).ready(function () {
        var $search = $('.search-btn');

        $('.search').click(function () {
            if ($search.hasClass('fa-search')) {
                w20.ui.openSearch();
            } else {
                w20.ui.closeSearch();
            }
        });

        $('pre code').each(function (i, block) {
            hljs.highlightBlock(block);
        });

        $('.side-menu').affix({
            offset: {
                top: $('#header').height() + 20,
                bottom: $('#footer').height() + 40
            }
        });

        Mousetrap.bind('/', function () {
            w20.ui.openSearch();
            return false;
        });

        Mousetrap.bind('alt+up', function () {
            if (w20.state.previousPage) {
                window.location = w20.state.previousPage;
            }
            return false;
        });

        Mousetrap.bind('alt+down', function () {
            if (w20.state.nextPage) {
                window.location = w20.state.nextPage;
            }
            return false;
        });

        Mousetrap.bind('esc', function () {
            w20.ui.closeSearch();
            return false;
        });

        var originalCallback = Mousetrap.stopCallback;
        Mousetrap.stopCallback = function (e, element, combo) {
            if (combo === 'esc') {
                return false;
            }

            return originalCallback(e, element, combo);
        };

        $('[data-toggle="tooltip"]').tooltip();

        $('#hotkeys-modal, #versions-modal').bind('hidden.bs.modal', function () {
            $("html").css("margin-right", "0px");
        }).bind('show.bs.modal', function () {
            $("html").css("margin-right", "-15px");
        });

        var query = w20.strings.parseQueryString(location);
        if (query.h && query.h.length > 0) {
            $('.doc-content').highlight(query.h);
            if (query.scroll) {
                $('html, body').animate({
                    scrollTop: $('span[class=highlight]:first').offset().top - 20
                }, 250);
            }
        }
    });
</script>


</body>
</html>
